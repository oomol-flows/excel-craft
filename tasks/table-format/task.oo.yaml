inputs_def:
  - handle: file_path
    description: "%path-to-the-excel-file-to-format%"
    json_schema:
      type: string
      ui:widget: file
    nullable: false

  - handle: formatting
    description: "%formatting-configuration%"
    json_schema:
      type: object
      properties:
        headerStyle:
          type: object
          ui:group:
            title: Header Style
            collapsed: true
          properties:
            bold:
              type: boolean
            italic:
              type: boolean
            fontSize:
              type: integer
            fontColor:
              type: string
            backgroundColor:
              type: string
            alignment:
              type: string
              enum:
                - left
                - center
                - right
            borderStyle:
              type: string
              enum:
                - thin
                - medium
                - thick
        columnWidths:
          type: object
          ui:group:
            title: Column & Row Dimensions
            collapsed: true
          additionalProperties:
            type: integer
        rowHeights:
          type: object
          additionalProperties:
            type: integer
        autoFitColumns:
          type: boolean
        conditionalFormats:
          type: array
          ui:group:
            title: Conditional Formatting
            collapsed: true
          items:
            type: object
            properties:
              range:
                type: string
              rule:
                type: string
                enum:
                  - cellValue
                  - expression
                  - colorScale
                  - dataBar
              condition:
                type: string
              style:
                type: object
              colors:
                type: array
                items:
                  type: string
        freeze:
          type: object
          ui:group:
            title: Freeze Panes
            collapsed: true
          properties:
            row:
              type: integer
            col:
              type: integer
        dataValidation:
          type: array
          ui:group:
            title: Data Validation
            collapsed: true
          items:
            type: object
            properties:
              range:
                type: string
              type:
                type: string
                enum:
                  - list
                  - whole
                  - decimal
                  - date
              values:
                type: array
              min:
                type: number
              max:
                type: number
    value: null
    nullable: true

  - handle: sheet_name
    description: "%sheet-name-to-format-default-first-sheet%"
    json_schema:
      type: string
    value: null
    nullable: true

outputs_def:
  - handle: file_path
    description: "%path-to-the-formatted-file%"
    json_schema:
      type: string

  - handle: success
    description: "%whether-formatting-was-successful%"
    json_schema:
      type: boolean

  - handle: applied_formats
    description: "%list-of-applied-format-types%"
    json_schema:
      type: array
      items:
        type: string

executor:
  name: python
  options:
    entry: __init__.py
    spawn: false

title: "%table-format-beautifier%"
icon: ":carbon:paint-brush:"
description: "%apply-excel-formatting-including-header-styles-column-widths-con%"
