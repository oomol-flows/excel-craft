inputs_def:
  - handle: file_path
    description: "%file-path-to-read-excel-csv-or-tsv%"
    json_schema:
      type: string
      ui:widget: file
      ui:options:
        filters:
          - name: Excel Files
            extensions:
              - xlsx
              - xls
          - name: CSV Files
            extensions:
              - csv
          - name: TSV Files
            extensions:
              - tsv
    nullable: false

  - handle: format
    description: "%file-format-default-auto-detect%"
    json_schema:
      type: string
      enum:
        - auto
        - csv
        - excel
        - tsv
    value: null
    nullable: true

  - handle: sheet_name
    description: "%excel-sheet-name-to-read-default-first-sheet%"
    json_schema:
      type: string
      ui:group:
        title: Excel Options
        collapsed: true
    value: null
    nullable: true

  - handle: sheet_index
    description: "%excel-sheet-index-0-based-default-0%"
    json_schema:
      type: integer
      minimum: 0
      ui:group:
        title: Excel Options
        collapsed: true
    value: null
    nullable: true

  - handle: header_row
    description: "%header-row-number-default-0%"
    json_schema:
      type: integer
      minimum: 0
      ui:group:
        title: Read Options
        collapsed: true
    value: null
    nullable: true

  - handle: encoding
    description: "%csv-encoding-default-utf-8%"
    json_schema:
      type: string
      ui:group:
        title: CSV/TSV Options
        collapsed: true
    value: null
    nullable: true

  - handle: skip_rows
    description: "%number-of-rows-to-skip-from-the-beginning%"
    json_schema:
      type: integer
      minimum: 0
      ui:group:
        title: Read Options
        collapsed: true
    value: null
    nullable: true

  - handle: max_rows
    description: "%maximum-number-of-rows-to-read-for-large-files%"
    json_schema:
      type: integer
      minimum: 1
      ui:group:
        title: Read Options
        collapsed: true
    value: null
    nullable: true

outputs_def:
  - handle: data
    description: "%table-data-as-array-of-records%"
    json_schema:
      type: array
      items:
        type: object

  - handle: columns
    description: "%column-names%"
    json_schema:
      type: array
      items:
        type: string

  - handle: shape
    description: "%table-shape-rows-and-columns-count%"
    json_schema:
      type: object
      properties:
        rows:
          type: integer
        cols:
          type: integer

  - handle: metadata
    description: "%file-metadata%"
    json_schema:
      type: object

executor:
  name: python
  options:
    entry: __init__.py
    spawn: false

title: "%table-reader%"
icon: ":carbon:document-import:"
description: "%read-excel-csv-or-tsv-files-and-return-structured-data-supports%"
