inputs_def:
  - handle: data
    description: "%table-data-to-write%"
    json_schema:
      type: array
      items:
        type: object
    nullable: false

  - handle: output_path
    description: "%output-file-path%"
    json_schema:
      type: string
      ui:widget: save
      ui:options:
        filters:
          - name: Excel Files
            extensions:
              - xlsx
          - name: CSV Files
            extensions:
              - csv
          - name: TSV Files
            extensions:
              - tsv
        excludeAll: true
    nullable: false

  - handle: format
    description: "%output-format-default-infer-from-file-extension%"
    json_schema:
      type: string
      enum:
        - csv
        - excel
        - tsv
    value: null
    nullable: true

  - handle: sheet_name
    description: "%excel-sheet-name-default-sheet1%"
    json_schema:
      type: string
      ui:group:
        title: Excel Options
        collapsed: true
    value: null
    nullable: true

  - handle: include_header
    description: "%include-column-headers-default-true%"
    json_schema:
      type: boolean
      ui:group:
        title: Output Options
        collapsed: true
    value: null
    nullable: true

  - handle: encoding
    description: "%csv-encoding-default-utf-82%"
    json_schema:
      type: string
      ui:group:
        title: CSV/TSV Options
        collapsed: true
    value: null
    nullable: true

  - handle: append
    description: "%append-to-existing-file-default-false%"
    json_schema:
      type: boolean
      ui:group:
        title: Output Options
        collapsed: true
    value: null
    nullable: true

  - handle: formatting
    description: "%excel-formatting-options%"
    json_schema:
      type: object
      ui:group:
        title: Excel Formatting
        collapsed: true
      properties:
        header_style:
          type: object
        column_widths:
          type: object
        auto_filter:
          type: boolean
        freeze_pane:
          type: object
    value: null
    nullable: true

outputs_def:
  - handle: file_path
    description: "%written-file-path%"
    json_schema:
      type: string

  - handle: rows_written
    description: "%number-of-rows-written%"
    json_schema:
      type: integer

  - handle: columns_written
    description: "%number-of-columns-written%"
    json_schema:
      type: integer

  - handle: file_size
    description: "%file-size-in-bytes%"
    json_schema:
      type: integer

  - handle: success
    description: "%whether-write-was-successful%"
    json_schema:
      type: boolean

  - handle: format
    description: "%format-used-for-writing%"
    json_schema:
      type: string

executor:
  name: python
  options:
    entry: __init__.py
    spawn: false

title: "%table-writer%"
icon: ":carbon:document-export:"
description: "%write-table-data-to-excel-csv-or-tsv-files-with-optional-formatt%"
