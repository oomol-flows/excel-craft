inputs_def:
  - handle: data
    description: "%table-data-to-aggregate%"
    json_schema:
      type: array
      items:
        type: object
    nullable: false

  - handle: mode
    description: "%aggregation-mode%"
    json_schema:
      type: string
      enum:
        - groupBy
        - pivot
    nullable: false

  - group: GroupBy Options
    collapsed: true

  - handle: group_by
    description: "%columns-to-group-by-for-groupby-mode%"
    json_schema:
      type: array
      items:
        type: string
    value: null
    nullable: true

  - handle: aggregations
    description: "%aggregation-functions-for-groupby-mode%"
    json_schema:
      type: array
      items:
        type: object
        properties:
          column:
            type: string
          function:
            type: string
            enum:
              - sum
              - avg
              - count
              - min
              - max
              - median
              - std
              - var
              - countUnique
              - first
              - last
              - list
          alias:
            type: string
    value: null
    nullable: true

  - group: Pivot Options
    collapsed: true

  - handle: pivot
    description: "%pivot-table-configuration-for-pivot-mode%"
    json_schema:
      type: object
      properties:
        index:
          type: array
          items:
            type: string
        columns:
          type: string
        values:
          type: string
        agg_func:
          type: string
        fill_value:
          anyOf:
            - type: number
            - type: string
            - type: "null"
    value: null
    nullable: true

outputs_def:
  - handle: data
    description: "%aggregated-table-data%"
    json_schema:
      type: array
      items:
        type: object

  - handle: mode
    description: "%aggregation-mode-used%"
    json_schema:
      type: string

  - handle: shape
    description: "%result-shape%"
    json_schema:
      type: object
      properties:
        rows:
          type: integer
        cols:
          type: integer

  - handle: group_count
    description: "%number-of-groups-groupby-mode-only%"
    json_schema:
      type: integer

  - handle: pivot_columns
    description: "%generated-column-names-pivot-mode-only%"
    json_schema:
      type: array
      items:
        type: string

executor:
  name: python
  options:
    entry: __init__.py
    spawn: false

title: "%table-aggregator%"
icon: ":carbon:chart-bar:"
description: "%aggregate-table-data-with-group-by-operations-or-pivot-tables-su%"
