title: "Test Formula Block"
description: "Test formula calculator block"

nodes:
  # Read sample data
  - node_id: reader#1
    task: self::table-reader
    inputs_from:
      - handle: file_path
        value: "/app/workspace/sample-data/sales_with_dates.csv"
      - handle: format
        value: null
      - handle: sheet_name
        value: null
      - handle: sheet_index
        value: null
      - handle: header_row
        value: null
      - handle: encoding
        value: null
      - handle: skip_rows
        value: null
      - handle: max_rows
        value: null

  # Apply formulas
  - node_id: formula#1
    task: self::table-formula
    inputs_from:
      - handle: data
        from_node:
          - node_id: reader#1
            output_handle: data
      - handle: formulas
        value:
          - column: "total"
            expression: "{quantity} * {price}"
          - column: "is_high_value"
            expression: "IF({quantity} > 15, 1, 0)"
          - column: "region_upper"
            expression: "UPPER(\"{region}\")"
      - handle: functions
        value: null
